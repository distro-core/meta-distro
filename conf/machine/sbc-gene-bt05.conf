# MACHINE.conf

# Intel Baytrail, Atom Aaeon GENE-BT05
# https://www.aaeon.com/en/p/3-and-half-inches-subcompact-boards-gene-bt05

# Aspects of build-in inclusion are denoted with the use of an OVERRIDE from
# MACHINEOVERRIDES. Where functionality is only available from a specific Yocto
# meta-* layer, incorporate the appropriate conditional checks and test with
# that layer absent.

# OVERRIDES                 Description
# none                      default packagegroup, required even if empty
# :${MACHINE}               additions based on MACHINE
# :libc-glibc               additions for runtime glibc, locales
# :libc-musl                additions for runtime musl
# :<machineoverride>        additions for MACHINEOVERRIDES

MACHINEOVERRIDES =. "intel-core2-32:"

# DEFAULTTUNE = "core2-64"

# EFI bootloader
EFI_PROVIDER = "grub-efi"
# meta-updater bootloader
OSTREE_BOOTLOADER = "grub"

require conf/machine/intel-core2-32.conf

# machine features
MACHINE_FEATURES += "acpi alsa bluetooth efi keyboard pci rtc screen serial usbgadget usbhost wifi tpm"
MACHINE_FEATURES:remove = "intel-ucode pcbios pcmcia phone tpm2"

# machine firmware
LICENSE_FLAGS_ACCEPTED:append = ""

# runqemu
# QEMUARCH = "x86"

# build artifacts
# IMAGE_FSTYPES += "ext4"
IMAGE_FSTYPES:remove = "image_repo_manifest ostreepush garagesign garagecheck ota-btrfs ota-ext4 wic"

require conf/machine/include/machine-common.inc
require conf/machine/include/machine-bootloader-${EFI_PROVIDER}.inc
require conf/machine/include/machine-providers.inc
# require ${@bb.utils.contains('IMAGE_FSTYPES', 'wic', 'conf/machine/include/machine-wic.inc', '', d)}

# initramfs (meta-updater assumes only one FSTYPES)
INITRAMFS_FSTYPES = "cpio.gz"
INITRAMFS_IMAGE = "initramfs"
INITRAMFS_MAXSIZE = "393216"
INITRAMFS_IMAGE_BUNDLE = "0"

# if "1", generate warnings for missing features
KERNEL_DANGLING_FEATURES_WARN_ONLY = "1"

# kernel
# PREFERRED_PROVIDER_virtual/kernel = "linux-intel"
KMACHINE = "intel-core2-32"
KTYPE = "standard"
KCONFIG_MODE = "allnoconfig"
KCONF_AUDIT_LEVEL = "0"
KCONF_BSP_AUDIT_LEVEL = "0"

# initial command line
APPEND = "panic=120 net.ifnames=1 audit=1"

# used by systemd-serialgetty or shadow-securetty
SERIAL_CONSOLES = "115200;ttyS1"

# machine specific boot packages
MACHINE_ESSENTIAL_EXTRA_RDEPENDS = ""

# KERNEL_MODULE_AUTOLOAD += "cdc-mbim qmi-wwan qcserial usb-wwan"

# KERNEL_MODULE_PROBECONF += "ath9k"
# module_conf_ath9k = "blacklist ath9k"
# MACHINE_EXTRA_RDEPENDS += "linux-firmware-ath9k"

# KERNEL_MODULE_PROBECONF += "brcmdhd"
# module_conf_brcmdhd = "blacklist brcmdhd"
# MACHINE_EXTRA_RDEPENDS: += "linux-firmware-bcm4329-fullmac"

# ---
