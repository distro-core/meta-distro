# conf/distro/include/distro-clang.inc

# Used to support clang as alternative compiler

# make additions for nonclangable and nonscanable to the appropriate
# sections below. TOOLCHAIN only effective when clang layer is available.

# selects "clang", "gcc"
TOOLCHAIN ?= "clang"
# if "1", include clang in sdk
CLANGSDK = "0"

# if set, selects c/c++ runtime from "gnu" or "llvm"
# TC_CXX_RUNTIME = "gnu"

# CLANG_EXTRA_OE_VENDORS:append = " ${DISTRO}"

# override provider of llvm
PREFERRED_PROVIDER_llvm:toolchain-clang = "clang"
PREFERRED_PROVIDER_llvm-native:toolchain-clang = "clang-native"
PREFERRED_PROVIDER_nativesdk-llvm:toolchain-clang = "nativesdk-clang"

# override provider of llvm
PROVIDES:pn-clang += "llvm"
PROVIDES:pn-clang-native += "llvm-native"
PROVIDES:pn-nativesdk-clang += "nativesdk-llvm"

# force clang per recipe
# TOOLCHAIN:forcevariable = "clang"
# DEPENDS:append:toolchain-clang = " clang-cross-${TARGET_ARCH}"

# nonclangable.conf TOOLCHAIN additions

# KERNEL_CC:toolchain-clang = "${CCACHE}clang ${HOST_CC_KERNEL_ARCH} -fuse-ld=lld ${DEBUG_PREFIX_MAP} -fdebug-prefix-map=${STAGING_KERNEL_DIR}=${KERNEL_SRC_PATH}"
# KERNEL_LD:toolchain-clang = "${CCACHE}ld.lld"
# KERNEL_AR:toolchain-clang = "${CCACHE}llvm-ar"

LTO:pn-efitools = ""

TOOLCHAIN:pn-acl = "gcc"
TOOLCHAIN:pn-btrfs-tools = "gcc"
TOOLCHAIN:pn-containerd-opencontainers = "gcc"
TOOLCHAIN:pn-coreutils = "gcc"
TOOLCHAIN:pn-efitools = "gcc"
TOOLCHAIN:pn-efivar = "gcc"
TOOLCHAIN:pn-ethtool = "gcc"
TOOLCHAIN:pn-flex = "gcc"
TOOLCHAIN:pn-gdbm = "gcc"
TOOLCHAIN:pn-gmp = "gcc"
TOOLCHAIN:pn-gnome-system-monitor = "gcc"
TOOLCHAIN:pn-gpgme = "gcc"
TOOLCHAIN:pn-libgudev = "gcc"
TOOLCHAIN:pn-libjxl = "gcc"
TOOLCHAIN:pn-libnl = "gcc"
TOOLCHAIN:pn-libpam = "gcc"
TOOLCHAIN:pn-libseccomp = "gcc"
TOOLCHAIN:pn-libxml2 = "gcc"
TOOLCHAIN:pn-lxc = "gcc"
TOOLCHAIN:pn-m4 = "gcc"
TOOLCHAIN:pn-mlvpn = "gcc"
TOOLCHAIN:pn-nettle = "gcc"
TOOLCHAIN:pn-openssl-tpm-engine = "gcc"
TOOLCHAIN:pn-ostree = "gcc"
TOOLCHAIN:pn-ostree-devicetrees = "gcc"
TOOLCHAIN:pn-ostree-initramfs = "gcc"
TOOLCHAIN:pn-ostree-kernel = "gcc"
TOOLCHAIN:pn-ostree-switchroot = "gcc"
TOOLCHAIN:pn-pcr-extend = "gcc"
TOOLCHAIN:pn-rsync = "gcc"
TOOLCHAIN:pn-runc-opencontainers = "gcc"
TOOLCHAIN:pn-sed = "gcc"
TOOLCHAIN:pn-seloader = "gcc"
TOOLCHAIN:pn-shim = "gcc"
TOOLCHAIN:pn-tini = "gcc"
TOOLCHAIN:pn-util-linux = "gcc"
# TOOLCHAIN:pn-webkitgtk = "gcc"

CFLAGS:append:pn-gtk+:toolchain-clang = " -Wno-error=incompatible-function-pointer-types"
CFLAGS:append:pn-libgee:toolchain-clang = " -Wno-error=incompatible-function-pointer-types"
CFLAGS:append:pn-gnome-font-viewer:toolchain-clang = " -Wno-error=incompatible-function-pointer-types"
CFLAGS:append:pn-tpm2-tss-engine:toolchain-clang = " -Wno-error=incompatible-function-pointer-types"
# CFLAGS:append:pn-webkitgtk:toolchain-clang = " -Wno-error=incompatible-function-pointer-types"
# CFLAGS:append:pn-webkitgtk3:toolchain-clang = " -Wno-error=incompatible-function-pointer-types"

# TOOLCHAIN:pn-${PREFERRED_PROVIDER_virtual/kernel} = "gcc"
# OBJCOPY:pn-${PREFERRED_PROVIDER_virtual/kernel}:toolchain-clang = "${HOST_PREFIX}objcopy"

# nonscanable.conf TOOLCHAIN additions

SCAN_BUILD:pn-alsa-state = ""
SCAN_BUILD:pn-bc = ""
SCAN_BUILD:pn-boost = ""
SCAN_BUILD:pn-c-ares = ""
SCAN_BUILD:pn-cjson = ""
SCAN_BUILD:pn-compose-file = ""
SCAN_BUILD:pn-container-host-config = ""
SCAN_BUILD:pn-containerd-opencontainers = ""
SCAN_BUILD:pn-efitools = ""
SCAN_BUILD:pn-expat = ""
SCAN_BUILD:pn-go-capability = ""
SCAN_BUILD:pn-go-cli = ""
SCAN_BUILD:pn-go-connections = ""
SCAN_BUILD:pn-go-context = ""
SCAN_BUILD:pn-go-dbus = ""
SCAN_BUILD:pn-go-digest = ""
SCAN_BUILD:pn-go-distribution = ""
SCAN_BUILD:pn-go-errors = ""
SCAN_BUILD:pn-go-fsnotify = ""
SCAN_BUILD:pn-go-logrus = ""
SCAN_BUILD:pn-go-mux = ""
SCAN_BUILD:pn-go-patricia = ""
SCAN_BUILD:pn-go-pty = ""
SCAN_BUILD:pn-go-runtime = ""
SCAN_BUILD:pn-go-systemd = ""
SCAN_BUILD:pn-gps-time-sync = ""
SCAN_BUILD:pn-grpc-go = ""
SCAN_BUILD:pn-grub-bootconf = ""
SCAN_BUILD:pn-hostapd = ""
SCAN_BUILD:pn-ima-policy = ""
SCAN_BUILD:pn-initrdscripts-ima = ""
SCAN_BUILD:pn-initrdscripts-secure-core = ""
SCAN_BUILD:pn-intel-microcode = ""
SCAN_BUILD:pn-internal-docker-network = ""
SCAN_BUILD:pn-iproute2 = ""
SCAN_BUILD:pn-iw = ""
SCAN_BUILD:pn-json-c = ""
SCAN_BUILD:pn-key-store = ""
SCAN_BUILD:pn-libwebsockets = ""
SCAN_BUILD:pn-make-mod-scripts = ""
SCAN_BUILD:pn-modem-mgr = ""
SCAN_BUILD:pn-ncurses = ""
SCAN_BUILD:pn-nlohmann-json = ""
SCAN_BUILD:pn-notary = ""
SCAN_BUILD:pn-oci-image-spec = ""
SCAN_BUILD:pn-oci-image-tools = ""
SCAN_BUILD:pn-oci-runtime-spec = ""
SCAN_BUILD:pn-oci-runtime-tools = ""
SCAN_BUILD:pn-openssh = ""
SCAN_BUILD:pn-openssl-tpm-engine = ""
SCAN_BUILD:pn-ostree-kernel-initramfs = ""
SCAN_BUILD:pn-paho-mqtt-c = ""
SCAN_BUILD:pn-paho-mqtt-cpp = ""
SCAN_BUILD:pn-python3-atomicwrites = ""
SCAN_BUILD:pn-python3-attrs = ""
SCAN_BUILD:pn-python3-importlib-metadata = ""
SCAN_BUILD:pn-python3-iniconfig = ""
SCAN_BUILD:pn-python3-more-itertools = ""
SCAN_BUILD:pn-python3-packaging = ""
SCAN_BUILD:pn-python3-paho-mqtt = ""
SCAN_BUILD:pn-python3-pathlib2 = ""
SCAN_BUILD:pn-python3-pluggy = ""
SCAN_BUILD:pn-python3-py = ""
SCAN_BUILD:pn-python3-pyparsing = ""
SCAN_BUILD:pn-python3-pyserial = ""
SCAN_BUILD:pn-python3-pytest = ""
SCAN_BUILD:pn-python3-pyudev = ""
SCAN_BUILD:pn-python3-setuptools = ""
SCAN_BUILD:pn-python3-six = ""
SCAN_BUILD:pn-python3-tomli = ""
SCAN_BUILD:pn-python3-wcwidth = ""
SCAN_BUILD:pn-python3-zipp = ""
SCAN_BUILD:pn-rsync = ""
SCAN_BUILD:pn-runc-opencontainers = ""
SCAN_BUILD:pn-sftp = ""
SCAN_BUILD:pn-shadow-sysroot = ""
SCAN_BUILD:pn-spf13-cobra = ""
SCAN_BUILD:pn-spf13-pflag = ""
SCAN_BUILD:pn-sudo = ""
SCAN_BUILD:pn-systemd-bootconf = ""
SCAN_BUILD:pn-systemd-compat-units = ""
SCAN_BUILD:pn-systemd-conf = ""
SCAN_BUILD:pn-systemd-journald = ""
SCAN_BUILD:pn-systemd-mm = ""
SCAN_BUILD:pn-systemd-serialgetty = ""
SCAN_BUILD:pn-tailscale = ""
SCAN_BUILD:pn-tini = ""
SCAN_BUILD:pn-tunctl = ""
SCAN_BUILD:pn-unzip = ""
SCAN_BUILD:pn-uthash = ""
SCAN_BUILD:pn-watchdog-config = ""
SCAN_BUILD:pn-yajl = ""
SCAN_BUILD:pn-zip = ""

# ---
